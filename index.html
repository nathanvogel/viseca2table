<!DOCTYPE html>
<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="utf-8">
  <!-- Primary Meta Tags -->
  <title>Viseca to Table</title>
  <meta name="title" content="Viseca to Table">
  <meta name="description" content="Easily import VisecaOne transactions in Excel/Google Sheets">

  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://metatags.io/">
  <meta property="og:title" content="Viseca to Table">
  <meta property="og:description" content="Easily import VisecaOne transactions in Excel/Google Sheets">
  <meta property="og:image" content="https://metatags.io/assets/meta-tags-16a33a6a8531e519cc0936fbba0ad904e52d35f34a46c97a2c9f6f7dd7d336f2.png">

  <!-- Twitter -->
  <meta property="twitter:card" content="summary_large_image">
  <meta property="twitter:url" content="https://metatags.io/">
  <meta property="twitter:title" content="Viseca to Table">
  <meta property="twitter:description" content="Easily import VisecaOne transactions in Excel/Google Sheets">
  <meta property="twitter:image" content="https://metatags.io/assets/meta-tags-16a33a6a8531e519cc0936fbba0ad904e52d35f34a46c97a2c9f6f7dd7d336f2.png">

  <link rel="stylesheet" type="text/css" href="style.css">

</head>
<body>
  <h2>Easily import VisecaOne transactions in Excel/Google Sheets</h2>
  <p>
    This script can be embedded as a bookmarklet in your browser.
    Just click on it to generate a table that you can copy-paste in Excel or Google Sheets.
    This works only on <a href="https://one.viseca.ch/transactions">https://one.viseca.ch/transactions</a>.
  </p>
  <p>
    Drag and drop this link to your bookmark bar:
    <p class="center">

    <a class="bookmarklet" href="javascript:void%20function(){function%20e(){var%20e=document.getElementById(%22main%22),t=document.createElement(%22TABLE%22);t.border=%221%22,t.id=%22visecasummarytable%22;var%20n=document.createElement(%22TBODY%22);return%20t.appendChild(n),e.insertBefore(t,e.firstChild),n}function%20t(){var%20t,a=document.getElementById(%22visecasummarytable%22);t=a%3Fa.getElementsByTagName(%22tbody%22)[0]:e();for(var%20m=0;m%3Cn.length;m++){var%20r=document.createElement(%22TR%22);t.appendChild(r);for(var%20l=0;l%3Cd.length;l++){var%20o=document.createElement(%22TD%22);o.width=%2275%22,o.appendChild(document.createTextNode(d[l][m].textContent)),r.appendChild(o)}}}var%20n=document.getElementsByClassName(%22name%22),a=document.getElementsByClassName(%22date-item--full%22),m=document.querySelectorAll('[data-ng-bind=%22transaction.amount%20|%20number:%202%22]'),d=[a,m,n];console.log(d),t()}();">
      VisecaOne to Table
    </a>
    </p>
    And click on it when the list of transactions you want to copy is displayed.
    If you want transactions from multiple pages, go to the next page and click again to add the transactions of the new page.
    Copy-paste your table!
    </p>
    <h2>Galaxus Order to Table</h2>
    <p>
      Drag and drop this link to your bookmark bar:
    </p>
    <p class="center">
    <a class="bookmarklet" href="javascript:(function()%7Bconst%20getDate%20%3D%20()%20%3D%3E%20%7B%0A%20%20const%20title%20%3D%20document.querySelector(%22%23pageContent%20%3E%20h1%22).textContent%3B%0A%20%20const%20dateMatch%20%3D%20title.match(%2F%5Cd%7B1%2C2%7D%5C%2F%5Cd%7B1%2C2%7D%5C%2F%5Cd%7B4%7D%2F)%3B%0A%0A%20%20if%20(dateMatch)%20%7B%0A%20%20%20%20const%20date%20%3D%20dateMatch%5B0%5D%3B%20%2F%2F%20Extracted%20date%0A%20%20%20%20return%20date.split(%22%2F%22).reverse().join(%22-%22)%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20console.error(%22No%20date%20found%22)%3B%0A%20%20%7D%0A%7D%3B%0A%0Aconst%20getTotalPrices%20%3D%20()%20%3D%3E%20%7B%0A%20%20const%20totalPrices%20%3D%20document.querySelectorAll(%22.totalPrice%22)%3B%0A%20%20return%20Array.from(totalPrices).map((price)%20%3D%3E%20%7B%0A%20%20%20%20const%20match%20%3D%20price.textContent.match(%2FCHF(%5Cd%2B%5C.%5Cd%2B)%2F)%3B%0A%20%20%20%20return%20%22-%22%20%2B%20(match%20%3F%20match%5B1%5D%20%3A%20price.textContent)%3B%0A%20%20%7D)%3B%0A%7D%3B%0A%0Aconst%20getDesciptions%20%3D%20()%20%3D%3E%20%7B%0A%20%20const%20descriptions%20%3D%20document.querySelectorAll(%0A%20%20%20%20%22div%3Ahas(%2B%20*%20%2B%20div.deliveryState)%22%0A%20%20)%3B%0A%20%20return%20Array.from(descriptions).map((description)%20%3D%3E%20description.textContent)%3B%0A%7D%3B%0A%0Aconst%20getTableData%20%3D%20()%20%3D%3E%20%7B%0A%20%20const%20descriptions%20%3D%20getDesciptions()%3B%0A%20%20const%20totalPrices%20%3D%20getTotalPrices()%3B%0A%20%20const%20date%20%3D%20getDate()%3B%0A%20%20const%20data%20%3D%20%5B%5D%3B%0A%0A%20%20for%20(let%20i%20%3D%200%3B%20i%20%3C%20descriptions.length%3B%20i%2B%2B)%20%7B%0A%20%20%20%20data.push(%7B%0A%20%20%20%20%20%20date%2C%0A%20%20%20%20%20%20description%3A%20descriptions%5Bi%5D%2C%0A%20%20%20%20%20%20totalPrice%3A%20totalPrices%5Bi%5D%2C%0A%20%20%20%20%7D)%3B%0A%20%20%7D%0A%0A%20%20console.log(data)%3B%0A%20%20return%20data%3B%0A%7D%3B%0A%0Aconst%20createTable%20%3D%20(data)%20%3D%3E%20%7B%0A%20%20const%20table%20%3D%20document.createElement(%22table%22)%3B%0A%20%20table.style.borderCollapse%20%3D%20%22collapse%22%3B%0A%20%20table.style.width%20%3D%20%22100%25%22%3B%0A%20%20table.style.marginTop%20%3D%20%2220px%22%3B%0A%20%20table.id%20%3D%20%22galaxus-order-table%22%3B%0A%0A%20%20const%20tbody%20%3D%20document.createElement(%22tbody%22)%3B%0A%20%20data.forEach((item)%20%3D%3E%20%7B%0A%20%20%20%20const%20row%20%3D%20document.createElement(%22tr%22)%3B%0A%20%20%20%20%5B%22date%22%2C%20%22description%22%2C%20%22totalPrice%22%5D.forEach((key)%20%3D%3E%20%7B%0A%20%20%20%20%20%20const%20td%20%3D%20document.createElement(%22td%22)%3B%0A%20%20%20%20%20%20td.textContent%20%3D%20item%5Bkey%5D%3B%0A%20%20%20%20%20%20td.style.border%20%3D%20%22none%22%3B%0A%20%20%20%20%20%20td.style.padding%20%3D%20%228px%22%3B%0A%20%20%20%20%20%20row.appendChild(td)%3B%0A%20%20%20%20%7D)%3B%0A%20%20%20%20tbody.appendChild(row)%3B%0A%20%20%7D)%3B%0A%20%20table.appendChild(tbody)%3B%0A%0A%20%20return%20table%3B%0A%7D%3B%0A%0A%2F%2F%20Add%20focus%20and%20selection%20functionality%0Aconst%20focusAndSelectTable%20%3D%20()%20%3D%3E%20%7B%0A%20%20const%20tableElement%20%3D%20document.querySelector(%22%23galaxus-order-table%22)%3B%0A%20%20if%20(tableElement)%20%7B%0A%20%20%20%20%2F%2F%20Create%20a%20range%20object%20and%20select%20the%20table%20contents%0A%20%20%20%20const%20range%20%3D%20document.createRange()%3B%0A%20%20%20%20range.selectNodeContents(tableElement)%3B%0A%0A%20%20%20%20%2F%2F%20Create%20a%20selection%20object%20and%20add%20the%20range%20to%20it%0A%20%20%20%20const%20selection%20%3D%20window.getSelection()%3B%0A%20%20%20%20selection.removeAllRanges()%3B%0A%20%20%20%20selection.addRange(range)%3B%0A%0A%20%20%20%20console.log(%22Table%20content%20focused%20and%20selected%22)%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20console.error(%22Table%20element%20not%20found%22)%3B%0A%20%20%7D%0A%7D%3B%0A%0Aconst%20insertTable%20%3D%20()%20%3D%3E%20%7B%0A%20%20const%20data%20%3D%20getTableData()%3B%0A%20%20const%20table%20%3D%20createTable(data)%3B%0A%20%20const%20targetElement%20%3D%20document.querySelector(%22%23pageContent%20%3E%20h1%22)%3B%0A%20%20if%20(targetElement)%20%7B%0A%20%20%20%20targetElement.insertAdjacentElement(%22afterend%22%2C%20table)%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20console.error(%22Target%20element%20not%20found%22)%3B%0A%20%20%7D%0A%0A%20%20%2F%2F%20Call%20the%20function%20after%20a%20short%20delay%20to%20ensure%20the%20table%20is%20in%20the%20DOM%0A%20%20setTimeout(focusAndSelectTable%2C%20100)%3B%0A%7D%3B%0A%0AinsertTable()%3B%7D)()%3B">GalaxusOrder to Table</a>
    </p>
    <p>
      When on a Galaxus order page, click on the bookmarklet to generate a table that you can copy-paste in Excel or Google Sheets.
    </p>
</body>
</html>
